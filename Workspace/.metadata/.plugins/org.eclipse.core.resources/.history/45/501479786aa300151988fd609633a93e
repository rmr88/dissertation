package launchers;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;

import com.gargoylesoftware.htmlunit.BrowserVersion;
import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.DomElement;
import com.gargoylesoftware.htmlunit.html.HtmlPage;
import com.gargoylesoftware.htmlunit.html.HtmlTable;
import com.gargoylesoftware.htmlunit.html.HtmlTableCell;
import com.gargoylesoftware.htmlunit.html.HtmlTableHeader;
import com.gargoylesoftware.htmlunit.html.HtmlTableRow;

import utilities.CandidateData;
import utilities.ElectionData;
import utilities.OutFile;

public class ScraperCO
{
	public static void main(String args[])
	{
		Logger.getLogger("com.gargoylesoftware").setLevel(Level.OFF);
		final WebClient wc = new WebClient(BrowserVersion.FIREFOX_38);

		ArrayList<DomElement> offices = new ArrayList<DomElement>();
		HtmlPage page = null;

		String state = "CO";
		String[] offices = {"governor"};
		String type = "county";
		int[] years = {2014, 2012};
		
		for (int year : years)
		{
			String outPath = "C:\\Users\\Robbie\\Documents\\dissertation\\Data"
					+ "\\elections\\stateResults\\" + state + "\\" + year + "_"
					+ type + ".txt";
			OutFile out = null;
			
			try
			{
				out = new OutFile(outPath, false);
			}
			catch (IOException e)
			{
				System.err.println("Error in setting up output file " + outPath);
				e.printStackTrace();
			}
			
			String yearSpecific;
			if (year > 2004)
				yearSpecific = "STatewideGeneral";
			else
				yearSpecific = "General";
			
			System.out.println("Year: " + year);
			
			for (String office : offices)
			{
				System.out.println(office);
				
				try
				{
					String url = "http://www.nvsos.gov/soselectionpages/results/"
							+ year + yearSpecific + "/" + office + ".aspx";
					page = wc.getPage(url);
				}
				catch (FailingHttpStatusCodeException | IOException e)
				{
					e.printStackTrace();
				}

				@SuppressWarnings("unchecked")
				ArrayList<HtmlTable> tables = (ArrayList<HtmlTable>) page.getByXPath("//table[@class='tableData']");

				ElectionData data;
				
//				for (int tableNum = 0; tableNum < offices.size(); tableNum++)
//				{
//					data = new ElectionData(state, type, location, year);
//					
//					try
//					{
//						out.write(data.getRows("\t"));
//					}
//					catch (IOException e)
//					{
//						System.err.println("Error in writing to file; data: " + data.getRows());
//						e.printStackTrace();
//					}
//				}
//				wc.close();
			}
			out.close();
		}
	}
}
