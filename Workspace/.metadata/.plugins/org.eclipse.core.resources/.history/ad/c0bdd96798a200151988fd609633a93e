package utilities;

import java.util.ArrayList;
import java.util.HashMap;

public class ElectionData
{
	private String office, state, type, location;
	private int year;
	private ArrayList<CandidateData> data = new ArrayList<CandidateData>();
	static HashMap<String, String> offices = new HashMap<String, String>();
	static ArrayList<String> checkedOffices = new ArrayList<String>();
	
	public ElectionData() {}
	
	public ElectionData(String _state, String _type, String _location, int _year)
	{
		this.year = _year;
		this.state = _state;
		this.location = _location;
		this.type = _type;
	}
	
	public void setOffice(String _office)
	{
		String off = _office.toUpperCase();
		
		if (offices.keySet().contains(off))
		{
			this.office = offices.get(off);
		}
		else if (!checkedOffices.contains(off))
		{
			String[] checkResult = check(off);
			if (!checkResult[0].isEmpty())
				offices.put(checkResult[0], checkResult[1]);
			else
				checkedOffices.add(off);
		}
	}
	
	private String[] check(String toCheck)
	{
		String check = "";
		String officeKey = "";
		
		for (Offices office : Offices.values())
		{
			int index = 0;
			String[] keys = office.getKeys();
			while (check.isEmpty() && index < keys.length)
			{
				if (toCheck.toUpperCase().contains(keys[index]))
				{
					int ind2 = 0;
					String [] exclusions = office.getExclusions();
					while (ind2 < exclusions.length)
					{
						if (!toCheck.toUpperCase().contains(exclusions[ind2]))
							check = office.toString();
						ind2++;
					}
				}
				index++;
			}
		}
		return new String[] {check, officeKey};
	}
	
	public void setLocation(String _location)
	{
		this.location = _location;
	}
	
	public void setState(String _state)
	{
		this.state = _state;
	}
	
	public void setType(String _type)
	{
		this.type = _type;
	}
	
	public void setYear(int _year)
	{
		this.year = _year;
	}
	
	public void addData(CandidateData d)
	{
		this.data.add(d);
	}
	
	public String getState()
	{
		return this.state;
	}
	
	public String getType()
	{
		return this.type;
	}
	
	public String getLocation()
	{
		return this.location;
	}
	
	public int getYear()
	{
		return this.year;
	}
	
	public ArrayList<CandidateData> getCandData()
	{
		return this.data;
	}
	
	public String getRows()
	{
		String rows = "";
		String delim = "\t";
		
		for(CandidateData d : this.data)
		{
			rows += this.state + delim +
					this.year + delim +
					this.type + delim +
					this.location + delim +
					this.office + delim +
					d.getRow(delim) + "\r\n";	
		}
		return rows;
	}
	
	public String getRows(String delim)
	{
		String rows = "";
		for(CandidateData d : this.data)
		{
			rows += this.state + delim +
					this.year + delim +
					this.type + delim +
					this.location + delim +
					this.office + delim +
					d.getRow(delim) + "\r\n";	
		}
		return rows;
	}
}
