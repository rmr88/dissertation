package launchers;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;

import utilities.DataObj;
import utilities.InFile;

public class AppendData
{
	public static void main(String args[])
	{
		//HashMap<String, Integer> headers = new HashMap<String, Integer>();
		ArrayList<String> headers = new ArrayList<String>();
		String basePath = "C:\\Users\\Robbie\\Documents\\dissertation\\Workspace\\"
				+ "dissertationData\\resources";
		InFile hdrFile = null;
		String line = "";
		int colIndex = 0;
		
		try
		{
			hdrFile = new InFile(basePath + "\\columnNamesTest.txt");
			while((line = hdrFile.readLine()) != null)
			{
				headers.add(line); //, colIndex);
				colIndex++;
			}
		}
		catch (IOException e)
		{
			System.err.println("Error in reading header file.");
			e.printStackTrace();
		}
		finally
		{
			hdrFile.close();
		} //end global header processing
		
		InFile in = null;
		File[] dataFiles = new File(basePath + "\\data").listFiles();
		HashMap<String, DataObj> data = new HashMap<String, DataObj>();
		String[] heads, row;
		
		for (File file : dataFiles)
		{
			data.clear();
			colIndex = 0;
			System.out.println(file.getName());
			int rows = 0;
			
			try
			{
				in = new InFile(file);
				heads = in.readRowLite("\t");
				for (String head : heads)
				{
					data.put(head, new DataObj(head, colIndex));
					colIndex++;
				}
				
				
				while ((row = in.readRowLite("\t")) != null)
				{
					int rowIndex = 0;
					while (rowIndex < row.length)
					{
						data.get(heads[rowIndex]).addData(row[rowIndex]);
						rowIndex++;
					}
					
					if (rowIndex > rows)
						rows = rowIndex;
				}
				
				
				
//				for (String key : data.keySet())
//					System.out.println(data.get(key));
			}
			catch (IOException e)
			{
				System.err.println("Error in reading file " + file.getAbsolutePath());
			}
			
			for (String header : headers) //.keySet())
				System.out.print(header + "\t");
			System.out.println();
			
			for (int index = 0; index < rows; index++) //TODO how do we know to stop at 4? need to get data array lengths, then adapt to handle missing data
			{
				for (String header : headers) //.keySet())
				{
					if (data.containsKey(header))
						System.out.print(data.get(header).getData().get(index) + "\t");
					else
						System.out.print("-\t");
				}
				System.out.println();
			}
		} //end for loop through dataFiles
		
//		for (String key : headers.keySet())
//			System.out.println(key + ": " + headers.get(key));
	} //end main
} //end AppendData
