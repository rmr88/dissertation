package tests;

import java.io.File;
import java.io.FilenameFilter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;

import utilities.InFile;
import utilities.OutFile;

public class GetTabCols
{
	public static void main(String args[])
	{
		File headerFile = new File("resources\\columnNames.txt");
		
		String basePath = "C:\\Users\\Robbie\\Documents\\dissertation\\Data\\elections";
		File[] tabFiles = new File(basePath + "\\EDAD").listFiles(new FilenameFilter()
			{
				public boolean accept(File dir, String name)
				{
					return name.endsWith(".tab");
				}
			});
		
		InFile in = null;
		ArrayList<String> cols = new ArrayList<String>();
		ArrayList<String> outArray = new ArrayList<String>();
		String line, piece;
		String[] headerArr, lineArr, outArr;
		HashMap<String, Integer> outputMap = new HashMap<String, Integer>();
		HashMap<String, Integer> inputMap = new HashMap<String, Integer>();
		int index = 0;
		
		try
		{
			OutFile out = new OutFile(basePath + "\\edadCombined.txt");
			in = new InFile(headerFile);
			while ((line = in.readLine()) != null)
			{
				outputMap.put(line, index);
				out.write(line + "\t");
				index++;
			}
			out.write("\r\n");
			
			//For getting initial columnNames.txt file.
//			for (String piece : line)
//			{
//				if (piece.matches("^g\\d{4}_.*"))
//					piece = "gYYYY" + piece.substring(5);
//				if (piece.matches("^r\\d{4}_.*"))
//					piece = "rYYYY" + piece.substring(5);
//				
//				if (!cols.contains(piece))
//					cols.add(piece);
//			}
			
//			for (File f : tabFiles)
//			{
				in = new InFile(tabFiles[0]);
				headerArr = in.readRowLite("\t");
				for (int i = 0; i < headerArr.length; i++)
				{
					piece = headerArr[i];
					if (piece.matches("^g\\d{4}_.*"))
						piece = "gYYYY" + piece.substring(5);
					if (piece.matches("^r\\d{4}_.*"))
						piece = "rYYYY" + piece.substring(5);
					
					if (cols.contains(piece))
						inputMap.put(headerArr[i], i);
					else
						inputMap.put(headerArr[i], -1);
				}
				
//				while ((lineArr = in.readRowLite("\t")) != null)
//				{
				lineArr = in.readRowLite("\t");
					for (int i = 0; i < lineArr.length; i++)
					{
						if (inputMap.get(headerArr[i]) != -1)
						{
							outArray.add(outputMap.get(headerArr[i]), lineArr[i]);
							System.out.println(outputMap.get(headerArr[i]) + ": " + lineArr[i]);
						}
					}
					out.writeRow(outArray.toArray(), "\t");
//				}
//			}
			
			out.close();
		}
		catch (IOException e)
		{
			e.printStackTrace();
		}
		
		for (String col : cols)
			System.out.println(col);
	}
}
